{% extends "core/base.html" %}
{% block content %}
<!-- Main Content -->
<main class="flex-grow-1 py-4 d-flex flex-column justify-content-center">
  <section class="container py-3 services-section">
    <div class="row g-3 justify-content-center">
      <!-- Panel de Perfil -->
      <div class="col-12 col-md-4 mb-3 mb-md-0">
        <div class="card text-center shadow-lg border-0 rounded-3">
          <div class="card-body p-4">
            <div class="mb-3">
              {% if worker.avatar %}
                <img src="{{ worker.avatar.url }}" alt="Avatar" class="img-fluid rounded-circle border border-3 border-primary" style="width: 110px; height: 110px;">
              {% else %}
                <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-profiles/avatar-1.webp" alt="Avatar" class="img-fluid rounded-circle border border-3 border-primary" style="width: 110px; height: 110px;">
              {% endif %}
            </div>
            <h4 class="fw-bold text-primary card-title fs-5">{{ worker.user.username }}</h4>
            <p class="text-secondary fw-semibold mb-1">{{ worker.get_estado_display }}</p>
            <p class="text-muted small mb-2">{{ worker.bio|default:"Sin biografía" }}</p>
            <a href="{% url 'worker_profile' %}" class="btn btn-outline-primary btn-sm fw-semibold">Volver al Perfil</a>
          </div>
        </div>
      </div>

      <!-- Formulario de Edición -->
      <div class="col-12 col-md-8">
        <div class="card shadow-lg border-0 rounded-3">
          <div class="card-header bg-primary text-white text-center" style="border-radius: 15px 15px 0 0;">
            <h3 class="mb-0 fw-bold fs-5">Editar Perfil del Trabajador</h3>
          </div>
          <div class="card-body p-3 p-md-4">
            <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
              {% csrf_token %}
              <!-- Campo Bio -->
              <div class="mb-3">
                <label for="{{ form.bio.id_for_label }}" class="form-label fw-bold text-primary">Biografía:</label>
                <small class="d-block text-muted mb-2">
                  Escribe algo sobre ti (máximo 250 caracteres).
                </small>
                {{ form.bio }}
                {% if form.bio.errors %}
                  <div class="invalid-feedback d-block text-danger">{{ form.bio.errors }}</div>
                {% endif %}
              </div>
              <!-- Campo Avatar -->
              <div class="mb-3">
                <label for="{{ form.avatar.id_for_label }}" class="form-label fw-bold text-primary">Avatar:</label>
                <small class="d-block text-muted mb-2">
                  Sube una foto tuya o una imagen que te represente.
                </small>
                {{ form.avatar }}
                {% if form.avatar.errors %}
                  <div class="invalid-feedback d-block text-danger">{{ form.avatar.errors }}</div>
                {% endif %}
                <small class="text-muted">
                  Tamaño máximo: 2MB. Formatos permitidos: JPG, PNG.
                </small>
              </div>
              <!-- Botón de envío -->
              <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary btn-lg fw-bold">
                  <i class="fas fa-save me-2"></i> Guardar Cambios
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>
<style>
body, html {
    min-height: 100%;
    overflow-y: auto;
    scrollbar-width: none;
    -ms-overflow-style: none;
}
body::-webkit-scrollbar {
    display: none;
}
/* Responsive adjustments */
@media (max-width: 767.98px) {
    .card {
        border-radius: 10px !important;
    }
    .card-body, .card-header {
        padding: 1rem !important;
    }
    .services-section {
        padding: 0 !important;
    }
    main.flex-grow-1 {
        padding: 0.5rem !important;
    }
    .row.g-3 {
        gap: 1rem !important;
    }
}
</style>
{% endblock %}